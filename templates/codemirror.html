{% extends "layout.html" %}
{% block body %}

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Classifying Puppet nodes</h4>
      </div>
      <div class="modal-body">
		<p>Cortex functions as a Puppet <i>External Node Classifier</i> or "ENC". You can use it to define what Puppet classes are used by nodes. Puppet defines a YAML based syntax
		for how ENCs tell Puppet what classes and parameters to load and Cortex exposes that to you verbatim. This allows you as the administrator to have full control over what
		a node's configuration is.</p>
		<p>PuppetLabs documentation for this syntax is here: <a href="https://docs.puppetlabs.com/guides/external_nodes.html">https://docs.puppetlabs.com/guides/external_nodes.html</a></p> 
		<h3>Defining classes</h3>
		<p>At the top of the field should be the line classes: without any indentation. Each subsequent line is the name of class to import, indented by two spaces and ending with a colon character. Here is an example:</p>

		<textarea id="demo1">classes:
  common:
  puppet:
  ntp:
</textarea>
		<p>God damn it.</p>
		
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<link href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/codemirror.min.css" rel="stylesheet">
<link href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/addon/lint/lint.min.css" rel="stylesheet">
<link href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/theme/ambiance.min.css" rel="stylesheet">

<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/codemirror.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/mode/yaml/yaml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/addon/lint/lint.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/js-yaml/3.4.6/js-yaml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.9.0/addon/lint/yaml-lint.js"></script>

<style type="text/css">
.CodeMirror {
  border: 1px solid #eee;
  height: auto;
}
</style>


<script>
$(document).ready(function(){	

	var editor = CodeMirror.fromTextArea(document.getElementById('classes'), 
	{
		mode: 'yaml',
		gutters: ["CodeMirror-lint-markers"],
		lint: true,
		indentUnit: 2,
		viewportMargin: Infinity
	});

	editor.setOption("extraKeys", 
	{
	  Tab: function(cm) {
		var spaces = Array(cm.getOption("indentUnit") + 1).join(" ");
		cm.replaceSelection(spaces);
	  }
	});

	var demo1 = CodeMirror.fromTextArea(document.getElementById('demo1'), 
	{
		mode: 'yaml',
		indentUnit: 2,
		readOnly: true,
	});

	demo1.setSize('100%', 120);

	$('#myModal').on('shown.bs.modal', function (e) {
		demo1.refresh();
	});
});
</script>

<h2>Classes</h2>
<div class="row">
	<div class="col-md-10">
		<textarea id="classes">
classes:
  common:
  puppet:
  ntp:
    ntpserver: 0.pool.ntp.org
  aptsetup:
    additional_apt_repos:
      - deb localrepo.example.com/ubuntu lucid production
      - deb localrepo.example.com/ubuntu lucid production
      - deb localrepo.example.com/ubuntu lucid production
</textarea>

	</div>

	<div class="col-md-2">
<div class="well well-sm">
  <strong>Help!</strong>
  <p>Use this field to define the classes that this node will import. You can also
define parameters for the classes.</p>
<p>The format of this field is YAML. Use two spaces for indentation. Do not use tabs, but you can safely
press tab (it will enter 2 spaces).</p>
<div class="text-center">
<button type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#myModal">
  Find out more
</button>
</div>
</div>
	</div>
</div>

{% endblock %}

